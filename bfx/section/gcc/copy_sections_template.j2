/**
 * Auto-generated file: Copy sections from FLASH to RAM before main()
 * This file is generated by BufferFlowX section management system.
 */

#include <string.h>

// Function declarations for copying sections
{% for section in sections %}
extern char _start{{ section.clean_section_name }}[];
extern char _end{{ section.clean_section_name }}[];
// For LMA (Load Memory Address), we use the symbol provided by the linker script
extern char __load_start{{ section.clean_section_name }}[];

{% endfor %}

// Copy function implementation
static void bfx_copy_sections_to_ram(void) {
{% for section in sections %}
    // Copy {{ section.full_section_name }} from FLASH to RAM
    memcpy(_start{{ section.clean_section_name }}, __load_start{{ section.clean_section_name }}, 
           _end{{ section.clean_section_name }} - _start{{ section.clean_section_name }});
{% endfor %}
}

// Constructor function that runs before main()
__attribute__((constructor)) void bfx_init_sections(void) {
    bfx_copy_sections_to_ram();
}